(function(L,window,document,undefined){"use strict";var mapIsFrozen=false;var createAlteredFunction=function(originalFunc){return function(e){if(mapIsFrozen){return false}originalFunc.call(this,e)}};L.Marker.prototype._bringToFront=createAlteredFunction(L.Marker.prototype._bringToFront);L.Marker.prototype._resetZIndex=createAlteredFunction(L.Marker.prototype._resetZIndex);L.Marker.prototype._onMouseClick=createAlteredFunction(L.Marker.prototype._onMouseClick);L.Marker.prototype._onKeyPress=createAlteredFunction(L.Marker.prototype._onKeyPress);L.Map.include({freeze:function(options){L.DomUtil.addClass(window.document.body,"map-is-frozen");if(options.beforeFreeze)options.beforeFreeze(this,options);this.save_style_cursor=this.getContainer().style.cursor;if(!options.allowPan)this.getContainer().style.cursor="default";if(this.zoomControl&&!options.allowZoom){this._addZoomControlWhenThaw=true;this.zoomControl.removeFrom(this)}this._freeze(options);mapIsFrozen=true;if(options.afterThaw){this.once("afterThaw",options.afterThaw)}},thaw:function(){this.getContainer().style.cursor=this.save_style_cursor;if(this.save_style_cursor){this.getContainer().style.cursor=this.save_style_cursor;this.save_style_cursor=null}if(this._addZoomControlWhenThaw){this.zoomControl.addTo(this);this._addZoomControlWhenThaw=false}this._thaw();L.DomUtil.removeClass(window.document.body,"map-is-frozen");mapIsFrozen=false;this.fire("afterThaw")}});L.Class.include({_freeze:function(options){function freezeIHandler(iHandlers){for(var i=0;i<iHandlers.length;i++){var iHandler=iHandlers[i];if(iHandler){iHandler.enableOnThaw=iHandler._enabled||iHandler.enabled&&iHandler.enabled();iHandler.disable();iHandler.frozen=true}}}this.clickableElementWhenThaw=this._icon||this._path||this._container;if(this.clickableElementWhenThaw){if(L.DomUtil.hasClass(this.clickableElementWhenThaw,"leaflet-clickable")){L.DomUtil.removeClass(this.clickableElementWhenThaw,"leaflet-clickable")}else{this.clickableElementWhenThaw=null}}freezeIHandler([this.keyboard,this.tap]);if(!options.allowZoom){freezeIHandler([this.touchZoom,this.doubleClickZoom,this.scrollWheelZoom,this.boxZoom])}if(!options.allowPan){freezeIHandler([this.dragging])}if(options.popup&&this.closePopup){this.closePopup()}if(this.hasEventListeners){this.disabledEvents={click:!options.allowClick,dblclick:true,preclick:true,contextmenu:true,mouseover:true,mouseout:true};this._save_hasEventListeners=this.hasEventListeners;this.hasEventListeners=this._hasEventListenersWhenDisabled;this._save_fireEvent=this.fireEvent;this.fireEvent=this._fireEventWhenDisabled;this._save_fire=this.fire;this.fire=this._fireEventWhenDisabled}if(this.eachLayer)this.eachLayer(function(layer){layer._freeze({})})},_thaw:function(){var iHandlers=[this.dragging,this.touchZoom,this.doubleClickZoom,this.scrollWheelZoom,this.boxZoom,this.keyboard,this.tap];for(var i=0;i<iHandlers.length;i++){var iHandler=iHandlers[i];if(iHandler&&iHandler.frozen){if(iHandler.enableOnThaw)iHandler.enable();iHandler.frozen=false}}if(this.clickableElementWhenThaw)L.DomUtil.addClass(this.clickableElementWhenThaw,"leaflet-clickable");if(this.disabledEvents){this.hasEventListeners=this._save_hasEventListeners;this.fireEvent=this._save_fireEvent;this.fire=this._save_fire;this.disabledEvents=null}if(this.eachLayer)this.eachLayer(function(layer){layer._thaw()})},_hasEventListenersWhenDisabled:function(type){if(type!="contextmenu"&&this.disabledEvents&&this.disabledEvents[type])return false;return L.Mixin.Events.hasEventListeners.call(this,type)},_fireEventWhenDisabled:function(type,data){if(type=="contextmenu"&&this.disabledEvents&&this.disabledEvents[type]){var event=L.Util.extend({},data,{type:type,target:this});L.DomEvent.stop(event);return false}return L.Mixin.Events.fireEvent.call(this,type,data)}})})(L,this,document);